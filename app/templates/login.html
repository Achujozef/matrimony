<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kerala Vishwakarma — Login</title>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{
      --brand:#0d6efd;               /* primary accent */
      --muted:#6c757d;
      --card-bg: rgba(255,255,255,0.95);
      --glass: rgba(255,255,255,0.7);
    }

    body {
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:
        radial-gradient(circle at 10% 20%, rgba(13,110,253,0.06), transparent 8%),
        radial-gradient(circle at 90% 80%, rgba(220,53,69,0.04), transparent 8%),
        linear-gradient(180deg, #f8fafc, #eef2f7 60%);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      padding:1.5rem;
    }

    .login-card {
      width:100%;
      max-width:980px;
      display:grid;
      grid-template-columns: 1fr 420px;
      gap:1.5rem;
      border-radius:16px;
      box-shadow: 0 10px 30px rgba(2,6,23,0.08);
      overflow:hidden;
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.9));
      backdrop-filter: blur(6px);
    }

    /* left marketing */
    .login-hero {
      padding:2rem 2.5rem;
      background: linear-gradient(135deg, rgba(13,110,253,0.03), rgba(0,123,255,0.02));
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:1rem;
    }
    .logo {
      display:flex;
      gap:.75rem;
      align-items:center;
    }
    .logo .badge-logo {
      width:56px;
      height:56px;
      border-radius:12px;
      display:inline-grid;
      place-items:center;
      font-weight:700;
      color:white;
      background: linear-gradient(135deg, var(--brand), #0b5ed7);
      box-shadow: 0 6px 18px rgba(13,110,253,0.15);
      font-size:18px;
    }
    .logo h1 { font-size:1.25rem; margin:0; letter-spacing:0.2px; }
    .logo p { margin:0; color:var(--muted); font-size:.9rem; }

    .hero-title { font-weight:700; font-size:1.35rem; margin:0; color:#0b2447; }
    .hero-sub { color:var(--muted); margin:0; font-size:.95rem; }

    .benefits { margin-top:1rem; display:flex; flex-direction:column; gap:.6rem; }
    .benefit { display:flex; gap:.75rem; align-items:flex-start; color:var(--muted); font-size:.95rem; }

    /* right form area */
    .login-form {
      padding:2rem;
      background:var(--card-bg);
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:1rem;
    }

    .form-title { font-weight:700; font-size:1.25rem; margin-bottom:0; color:#10203a; }
    .form-sub { color:var(--muted); font-size:.92rem; margin-bottom:1rem; }

    .social-row { display:flex; gap:.6rem; }
    .social-btn {
      flex:1;
      border-radius:10px;
      padding:.5rem .6rem;
      font-weight:600;
      font-size:.95rem;
    }

    .divider { display:flex; gap:.75rem; align-items:center; color:var(--muted); font-size:.9rem; margin: .5rem 0; }
    .divider::before, .divider::after { content:""; flex:1; height:1px; background:#e9ecef; border-radius:2px; }

    .form-actions { display:flex; justify-content:space-between; align-items:center; gap:1rem; margin-top:.5rem; }
    .btn-primary { background:var(--brand); border-color:var(--brand); }
    .small-muted { color:var(--muted); font-size:.9rem; }

    /* toast container top-right spacing */
    .toast-container { position: fixed; top:1rem; right:1rem; z-index:1200; }

    /* small screens: stack columns */
    @media (max-width:880px) {
      .login-card { grid-template-columns:1fr; max-width:520px; padding:0; border-radius:12px; }
      .login-hero { order:2; padding:1.25rem; }
      .login-form { order:1; padding:1.25rem; }
    }
  </style>
</head>
<body>

  <div class="login-card">
    <!-- left: hero / marketing -->
    <div class="login-hero">
      <div class="logo">
        <div class="badge-logo">KV</div>
        <div>
          <h1>Kerala Vishwakarma</h1>
          <p>Community Matrimonial — Trusted profiles within your shakha</p>
        </div>
      </div>

      <h2 class="hero-title">Find the right match inside your community</h2>
      <p class="hero-sub">Secure, verified profiles — Shakha presidents validate new registrations before they appear publicly.</p>

      <div class="benefits">
        <div class="benefit">
          <svg width="18" height="18" fill="#0b5ed7" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6 10.793 3.354 8.146 2.646 8.854 6 12.207l8-8-0.707-0.707L6 10.793z"/></svg>
          <div>Shakha-verified profiles only</div>
        </div>
        <div class="benefit">
          <svg width="18" height="18" fill="#0b5ed7" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 4h8v1H4zM4 7h8v1H4zM4 10h5v1H4z"/></svg>
          <div>Private photos and contact control</div>
        </div>
        <div class="benefit">
          <svg width="18" height="18" fill="#0b5ed7" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1zM4.146 8.354 6.5 10.707 11.854 5.354 10.5 4l-4 4-1.354-1.646L4.146 8.354z"/></svg>
          <div>Manual premium activation & secure payments</div>
        </div>
      </div>

      <p class="small-muted mt-3">Not a member of any shakha? Contact your local shakha president to join the community.</p>
    </div>

    <!-- right: form -->
    <div class="login-form">
      <div>
        <h3 class="form-title">Welcome back</h3>
        <div class="form-sub">Login with your community email to continue</div>
      </div>

        <!-- Server messages rendered as toasts -->
        <div class="toast-container" aria-live="polite" aria-atomic="true">
        {% for message in messages %}
            {% if 'error' in message.tags %}
            <div class="toast align-items-center text-bg-danger border-0 mb-2" role="alert" aria-live="assertive" aria-atomic="true">
            {% else %}
            <div class="toast align-items-center text-bg-success border-0 mb-2" role="alert" aria-live="assertive" aria-atomic="true">
            {% endif %}
                <div class="d-flex">
                <div class="toast-body">
                    {{ message }}
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
            </div>
        {% endfor %}
        </div>


      <!-- Social buttons (placeholders) -->
      <div class="social-row mb-2">
        <button type="button" class="btn btn-outline-primary social-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-google" viewBox="0 0 16 16"><path d="M8 8v.5h4.292C12.93 10.1 11.64 11 10 11c-2.21 0-4-1.79-4-4s1.79-4 4-4c1.08 0 2 .45 2.75 1.17L12.5 5.5H8V8z"/></svg>
          Google
        </button>
        <button type="button" class="btn btn-outline-secondary social-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-apple" viewBox="0 0 16 16"><path d="M11.5 1.2c-.7.1-1.4.6-1.9 1.2-.4.5-.8 1.1-.7 1.6.8.1 1.7-.4 2.2-1 .5-.5.8-1.1.4-1.8z"/></svg>
          Apple
        </button>
      </div>

      <div class="divider">or sign in with email</div>

      <!-- Login form -->
      <form method="post" action="{% url 'login' %}" id="loginForm" novalidate>
        {% csrf_token %}

        <div class="mb-3">
          <label for="email" class="form-label required">Email</label>
          <input id="email" name="email" type="email" class="form-control" placeholder="you@domain.com" required>
        </div>

        <div class="mb-3 position-relative">
          <label for="password" class="form-label required">Password</label>
          <div class="input-group">
            <input id="password" name="password" type="password" class="form-control" placeholder="Enter password" required minlength="8" aria-describedby="togglePassword">
            <button id="togglePassword" class="btn btn-outline-secondary" type="button" tabindex="-1" title="Show / hide password">
              <svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16"><path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8z"/><path d="M8 5a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"/></svg>
            </button>
          </div>
          <div id="passwordHelp" class="form-text small-muted">Password must be at least 8 characters.</div>
        </div>

        <div class="form-actions">
          <div class="form-check">
            <input id="remember" name="remember" class="form-check-input" type="checkbox">
            <label class="form-check-label small-muted" for="remember">Remember me</label>
          </div>

          <div class="small-muted">
            <a href="{% url 'password_reset' %}">Forgot password?</a>
          </div>
        </div>

        <div class="mt-3 d-grid">
          <button id="submitBtn" type="submit" class="btn btn-primary btn-lg">Sign in</button>
        </div>

        <p class="text-center small-muted mt-3">Don't have an account? <a href="{% url 'register' %}">Register</a><br><a href="{% url 'shakha_login' %}">Shakha Login</a></p>
      </form>
    </div>
  </div>

  <!-- Bootstrap Bundle (includes Popper) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Show any server messages toasts automatically on page load
    document.addEventListener('DOMContentLoaded', function () {
      document.querySelectorAll('.toast').forEach(function(t){
        var b = new bootstrap.Toast(t, { delay: 4000 });
        b.show();
      });
    });

    // Toggle password visibility
    document.getElementById('togglePassword').addEventListener('click', function(e){
      var pwd = document.getElementById('password');
      var eyeIcon = document.getElementById('eyeIcon');
      if (pwd.type === 'password') {
        pwd.type = 'text';
        eyeIcon.innerHTML = '<path d="M13.359 11.238C12.106 12.232 10.666 12.8 9 12.8 4 12.8 1 8 1 8s1.893-2.93 5.44-5.044l1.06.964C6.455 7.08 6 8 6 8s1.455 1.92 4.5 1.92c1.243 0 2.439-.365 3.481-1.045l-.122-.637z"></path>';
      } else {
        pwd.type = 'password';
        eyeIcon.innerHTML = '<path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8z"/><path d="M8 5a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"/>';
      }
    });

    // Client-side validation UX: show toast instead of browser default
    document.getElementById('loginForm').addEventListener('submit', function(e){
      var email = document.getElementById('email');
      var password = document.getElementById('password');

      if (!email.value.trim() || !password.value.trim()) {
        e.preventDefault();
        // bootstrap toast dynamic creation
        var toastContainer = document.querySelector('.toast-container');
        var toastEl = document.createElement('div');
        toastEl.className = 'toast align-items-center text-bg-danger border-0 mb-2';
        toastEl.role = 'alert';
        toastEl.setAttribute('aria-live','assertive');
        toastEl.setAttribute('aria-atomic','true');
        toastEl.innerHTML = '<div class="d-flex"><div class="toast-body">Please enter both email and password.</div><button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button></div>';
        toastContainer.appendChild(toastEl);
        var b = new bootstrap.Toast(toastEl, { delay: 3500 });
        b.show();
        return false;
      }

      // allow submission - server will handle auth
    });
  </script>
</body>
</html>
